/*
 * jQuery Pines Notify (pnotify) Plugin 1.0.2
 *
 * Copyright (c) 2009-2011 Hunter Perrin
 *
 * Triple license under the GPL, LGPL, and MPL:
 *	  http://www.gnu.org/licenses/gpl.html
 *	  http://www.gnu.org/licenses/lgpl.html
 *	  http://www.mozilla.org/MPL/MPL-1.1.html
 */
(function(e){var n,j,g,k;e.extend({pnotify_remove_all:function(){var d=g.data("pnotify");d&&d.length&&e.each(d,function(){this.pnotify_remove&&this.pnotify_remove()})},pnotify_position_all:function(){j&&clearTimeout(j);j=null;var d=g.data("pnotify");d&&d.length&&(e.each(d,function(){var c=this.opts.pnotify_stack;if(c){if(!c.nextpos1)c.nextpos1=c.firstpos1;if(!c.nextpos2)c.nextpos2=c.firstpos2;if(!c.addpos2)c.addpos2=0;if(this.css("display")!="none"){var a,e,d={},b;switch(c.dir1){case "down":b="top";
break;case "up":b="bottom";break;case "left":b="right";break;case "right":b="left"}a=parseInt(this.css(b));isNaN(a)&&(a=0);if(typeof c.firstpos1=="undefined")c.firstpos1=a,c.nextpos1=c.firstpos1;var f;switch(c.dir2){case "down":f="top";break;case "up":f="bottom";break;case "left":f="right";break;case "right":f="left"}e=parseInt(this.css(f));isNaN(e)&&(e=0);if(typeof c.firstpos2=="undefined")c.firstpos2=e,c.nextpos2=c.firstpos2;if(c.dir1=="down"&&c.nextpos1+this.height()>k.height()||c.dir1=="up"&&
c.nextpos1+this.height()>k.height()||c.dir1=="left"&&c.nextpos1+this.width()>k.width()||c.dir1=="right"&&c.nextpos1+this.width()>k.width())c.nextpos1=c.firstpos1,c.nextpos2+=c.addpos2+10,c.addpos2=0;if(c.animation&&c.nextpos2<e)switch(c.dir2){case "down":d.top=c.nextpos2+"px";break;case "up":d.bottom=c.nextpos2+"px";break;case "left":d.right=c.nextpos2+"px";break;case "right":d.left=c.nextpos2+"px"}else this.css(f,c.nextpos2+"px");switch(c.dir2){case "down":case "up":if(this.outerHeight(!0)>c.addpos2)c.addpos2=
this.height();break;case "left":case "right":if(this.outerWidth(!0)>c.addpos2)c.addpos2=this.width()}if(c.nextpos1)if(c.animation&&(a>c.nextpos1||d.top||d.bottom||d.right||d.left))switch(c.dir1){case "down":d.top=c.nextpos1+"px";break;case "up":d.bottom=c.nextpos1+"px";break;case "left":d.right=c.nextpos1+"px";break;case "right":d.left=c.nextpos1+"px"}else this.css(b,c.nextpos1+"px");(d.top||d.bottom||d.right||d.left)&&this.animate(d,{duration:500,queue:!1});switch(c.dir1){case "down":case "up":c.nextpos1+=
this.height()+10;break;case "left":case "right":c.nextpos1+=this.width()+10}}}}),e.each(d,function(){var c=this.opts.pnotify_stack;if(c)c.nextpos1=c.firstpos1,c.nextpos2=c.firstpos2,c.addpos2=0,c.animation=!0}))},pnotify:function(d){g||(g=e("body"));k||(k=e(window));var c,a;typeof d!="object"?(a=e.extend({},e.pnotify.defaults),a.pnotify_text=d):a=e.extend({},e.pnotify.defaults,d);if(a.pnotify_before_init&&a.pnotify_before_init(a)===!1)return null;var h,l=function(a,c){b.css("display","none");var d=
document.elementFromPoint(a.clientX,a.clientY);b.css("display","block");var f=e(d),g=f.css("cursor");b.css("cursor",g!="auto"?g:"default");if(!h||h.get(0)!=d)h&&(m.call(h.get(0),"mouseleave",a.originalEvent),m.call(h.get(0),"mouseout",a.originalEvent)),m.call(d,"mouseenter",a.originalEvent),m.call(d,"mouseover",a.originalEvent);m.call(d,c,a.originalEvent);h=f},b=e("<div />",{"class":"ui-pnotify "+a.pnotify_addclass,css:{display:"none"},mouseenter:function(o){a.pnotify_nonblock&&o.stopPropagation();
a.pnotify_mouse_reset&&c=="out"&&(b.stop(!0),c="in",b.css("height","auto").animate({width:a.pnotify_width,opacity:a.pnotify_nonblock?a.pnotify_nonblock_opacity:a.pnotify_opacity},"fast"));a.pnotify_nonblock&&b.animate({opacity:a.pnotify_nonblock_opacity},"fast");a.pnotify_hide&&a.pnotify_mouse_reset&&b.pnotify_cancel_remove();a.pnotify_closer&&!a.pnotify_nonblock&&b.closer.show()},mouseleave:function(o){a.pnotify_nonblock&&o.stopPropagation();h=null;b.css("cursor","auto");a.pnotify_nonblock&&c!="out"&&
b.animate({opacity:a.pnotify_opacity},"fast");a.pnotify_hide&&a.pnotify_mouse_reset&&b.pnotify_queue_remove();b.closer.hide();e.pnotify_position_all()},mouseover:function(b){a.pnotify_nonblock&&b.stopPropagation()},mouseout:function(b){a.pnotify_nonblock&&b.stopPropagation()},mousemove:function(b){a.pnotify_nonblock&&(b.stopPropagation(),l(b,"onmousemove"))},mousedown:function(b){a.pnotify_nonblock&&(b.stopPropagation(),b.preventDefault(),l(b,"onmousedown"))},mouseup:function(b){a.pnotify_nonblock&&
(b.stopPropagation(),b.preventDefault(),l(b,"onmouseup"))},click:function(b){a.pnotify_nonblock&&(b.stopPropagation(),l(b,"onclick"))},dblclick:function(b){a.pnotify_nonblock&&(b.stopPropagation(),l(b,"ondblclick"))}});b.opts=a;if(a.pnotify_shadow&&!e.browser.msie)b.shadow_container=e("<div />",{"class":"ui-widget-shadow ui-corner-all ui-pnotify-shadow"}).prependTo(b);b.container=e("<div />",{"class":"ui-widget ui-widget-content ui-corner-all ui-pnotify-container "+(a.pnotify_type=="error"?"ui-state-error":
"ui-state-highlight")}).appendTo(b);b.pnotify_version="1.0.2";b.pnotify=function(c){var d=a;typeof c=="string"?a.pnotify_text=c:a=e.extend({},a,c);b.opts=a;if(a.pnotify_shadow!=d.pnotify_shadow)a.pnotify_shadow&&!e.browser.msie?b.shadow_container=e("<div />",{"class":"ui-widget-shadow ui-pnotify-shadow"}).prependTo(b):b.children(".ui-pnotify-shadow").remove();a.pnotify_addclass===!1?b.removeClass(d.pnotify_addclass):a.pnotify_addclass!==d.pnotify_addclass&&b.removeClass(d.pnotify_addclass).addClass(a.pnotify_addclass);
a.pnotify_title===!1?b.title_container.hide("fast"):a.pnotify_title!==d.pnotify_title&&b.title_container.html(a.pnotify_title).show(200);if(a.pnotify_text===!1)b.text_container.hide("fast");else if(a.pnotify_text!==d.pnotify_text){if(a.pnotify_insert_brs)a.pnotify_text=a.pnotify_text.replace(/\n/g,"<br />");b.text_container.html(a.pnotify_text).show(200)}b.pnotify_history=a.pnotify_history;a.pnotify_type!=d.pnotify_type&&b.container.toggleClass("ui-state-error ui-state-highlight");if(a.pnotify_notice_icon!=
d.pnotify_notice_icon&&a.pnotify_type=="notice"||a.pnotify_error_icon!=d.pnotify_error_icon&&a.pnotify_type=="error"||a.pnotify_type!=d.pnotify_type)if(b.container.find("div.ui-pnotify-icon").remove(),a.pnotify_error_icon&&a.pnotify_type=="error"||a.pnotify_notice_icon)e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":a.pnotify_type=="error"?a.pnotify_error_icon:a.pnotify_notice_icon})).prependTo(b.container);a.pnotify_width!==d.pnotify_width&&b.animate({width:a.pnotify_width});
a.pnotify_min_height!==d.pnotify_min_height&&b.container.animate({minHeight:a.pnotify_min_height});a.pnotify_opacity!==d.pnotify_opacity&&b.fadeTo(a.pnotify_animate_speed,a.pnotify_opacity);a.pnotify_hide?d.pnotify_hide||b.pnotify_queue_remove():b.pnotify_cancel_remove();b.pnotify_queue_position();return b};b.pnotify_queue_position=function(){j&&clearTimeout(j);j=setTimeout(e.pnotify_position_all,10)};b.pnotify_display=function(){b.parent().length||b.appendTo(g);a.pnotify_before_open&&a.pnotify_before_open(b)===
!1||(b.pnotify_queue_position(),a.pnotify_animation=="fade"||a.pnotify_animation.effect_in=="fade"?b.show().fadeTo(0,0).hide():a.pnotify_opacity!=1&&b.show().fadeTo(0,a.pnotify_opacity).hide(),b.animate_in(function(){a.pnotify_after_open&&a.pnotify_after_open(b);b.pnotify_queue_position();a.pnotify_hide&&b.pnotify_queue_remove()}))};b.pnotify_remove=function(){if(b.timer)window.clearTimeout(b.timer),b.timer=null;a.pnotify_before_close&&a.pnotify_before_close(b)===!1||b.animate_out(function(){a.pnotify_after_close&&
a.pnotify_after_close(b)===!1||(b.pnotify_queue_position(),a.pnotify_remove&&b.detach())})};b.animate_in=function(d){c="in";var e;e=typeof a.pnotify_animation.effect_in!="undefined"?a.pnotify_animation.effect_in:a.pnotify_animation;e=="none"?(b.show(),d()):e=="show"?b.show(a.pnotify_animate_speed,d):e=="fade"?b.show().fadeTo(a.pnotify_animate_speed,a.pnotify_opacity,d):e=="slide"?b.slideDown(a.pnotify_animate_speed,d):typeof e=="function"?e("in",d,b):b.effect&&b.effect(e,{},a.pnotify_animate_speed,
d)};b.animate_out=function(d){c="out";var e;e=typeof a.pnotify_animation.effect_out!="undefined"?a.pnotify_animation.effect_out:a.pnotify_animation;e=="none"?(b.hide(),d()):e=="show"?b.hide(a.pnotify_animate_speed,d):e=="fade"?b.fadeOut(a.pnotify_animate_speed,d):e=="slide"?b.slideUp(a.pnotify_animate_speed,d):typeof e=="function"?e("out",d,b):b.effect&&b.effect(e,{},a.pnotify_animate_speed,d)};b.pnotify_cancel_remove=function(){b.timer&&window.clearTimeout(b.timer)};b.pnotify_queue_remove=function(){b.pnotify_cancel_remove();
b.timer=window.setTimeout(function(){b.pnotify_remove()},isNaN(a.pnotify_delay)?0:a.pnotify_delay)};b.closer=e("<div />",{"class":"ui-pnotify-closer",css:{cursor:"pointer",display:"none"},click:function(){b.pnotify_remove();b.closer.hide()}}).append(e("<span />",{"class":"ui-icon ui-icon-circle-close"})).appendTo(b.container);if(a.pnotify_error_icon&&a.pnotify_type=="error"||a.pnotify_notice_icon)e("<div />",{"class":"ui-pnotify-icon"}).append(e("<span />",{"class":a.pnotify_type=="error"?a.pnotify_error_icon:
a.pnotify_notice_icon})).appendTo(b.container);b.title_container=e("<div />",{"class":"ui-pnotify-title",html:a.pnotify_title}).appendTo(b.container);a.pnotify_title===!1&&b.title_container.hide();if(a.pnotify_insert_brs&&typeof a.pnotify_text=="string")a.pnotify_text=a.pnotify_text.replace(/\n/g,"<br />");b.text_container=e("<div />",{"class":"ui-pnotify-text",html:a.pnotify_text}).appendTo(b.container);a.pnotify_text===!1&&b.text_container.hide();typeof a.pnotify_width=="string"&&b.css("width",
a.pnotify_width);typeof a.pnotify_min_height=="string"&&b.container.css("min-height",a.pnotify_min_height);b.pnotify_history=a.pnotify_history;var f=g.data("pnotify");if(f==null||typeof f!="object")f=[];f=a.pnotify_stack.push=="top"?e.merge([b],f):e.merge(f,[b]);g.data("pnotify",f);a.pnotify_after_init&&a.pnotify_after_init(b);if(a.pnotify_history){var i=g.data("pnotify_history");typeof i=="undefined"&&(i=e("<div />",{"class":"ui-pnotify-history-container ui-state-default ui-corner-bottom",mouseleave:function(){i.animate({top:"-"+
n+"px"},{duration:100,queue:!1})}}).append(e("<div />",{"class":"ui-pnotify-history-header",text:"Redisplay"})).append(e("<button />",{"class":"ui-pnotify-history-all ui-state-default ui-corner-all",text:"All",mouseenter:function(){e(this).addClass("ui-state-hover")},mouseleave:function(){e(this).removeClass("ui-state-hover")},click:function(){e.each(f,function(){this.pnotify_history&&this.pnotify_display&&this.pnotify_display()});return!1}})).append(e("<button />",{"class":"ui-pnotify-history-last ui-state-default ui-corner-all",
text:"Last",mouseenter:function(){e(this).addClass("ui-state-hover")},mouseleave:function(){e(this).removeClass("ui-state-hover")},click:function(){for(var a=1;!f[f.length-a]||!f[f.length-a].pnotify_history||f[f.length-a].is(":visible");){if(f.length-a===0)return!1;a++}a=f[f.length-a];a.pnotify_display&&a.pnotify_display();return!1}})).appendTo(g),n=e("<span />",{"class":"ui-pnotify-history-pulldown ui-icon ui-icon-grip-dotted-horizontal",mouseenter:function(){i.animate({top:"0"},{duration:100,queue:!1})}}).appendTo(i).offset().top+
2,i.css({top:"-"+n+"px"}),g.data("pnotify_history",i))}a.pnotify_stack.animation=!1;b.pnotify_display();return b}});var p=/^on/,q=/^(dbl)?click$|^mouse(move|down|up|over|out|enter|leave)$|^contextmenu$/,r=/^(focus|blur|select|change|reset)$|^key(press|down|up)$/,s=/^(scroll|resize|(un)?load|abort|error)$/,m=function(d,c){var a,d=d.toLowerCase();document.createEvent&&this.dispatchEvent?(d=d.replace(p,""),d.match(q)?(e(this).offset(),a=document.createEvent("MouseEvents"),a.initMouseEvent(d,c.bubbles,
c.cancelable,c.view,c.detail,c.screenX,c.screenY,c.clientX,c.clientY,c.ctrlKey,c.altKey,c.shiftKey,c.metaKey,c.button,c.relatedTarget)):d.match(r)?(a=document.createEvent("UIEvents"),a.initUIEvent(d,c.bubbles,c.cancelable,c.view,c.detail)):d.match(s)&&(a=document.createEvent("HTMLEvents"),a.initEvent(d,c.bubbles,c.cancelable)),a&&this.dispatchEvent(a)):(d.match(p)||(d="on"+d),a=document.createEventObject(c),this.fireEvent(d,a))};e.pnotify.defaults={pnotify_title:!1,pnotify_text:!1,pnotify_addclass:"",
pnotify_nonblock:!1,pnotify_nonblock_opacity:0.2,pnotify_history:!0,pnotify_width:"300px",pnotify_min_height:"16px",pnotify_type:"notice",pnotify_notice_icon:"ui-icon ui-icon-info",pnotify_error_icon:"ui-icon ui-icon-alert",pnotify_animation:"fade",pnotify_animate_speed:"slow",pnotify_opacity:1,pnotify_shadow:!1,pnotify_closer:!0,pnotify_hide:!0,pnotify_delay:8E3,pnotify_mouse_reset:!0,pnotify_remove:!0,pnotify_insert_brs:!0,pnotify_stack:{dir1:"down",dir2:"left",push:"bottom"}}})(jQuery);
