#import os.path
#import sickbeard
#from sickbeard.common import *
#from sickbeard import config
#from sickbeard import metadata
#from sickbeard.metadata.generic import GenericMetadata
#from sickbeard import naming

#set global $title  = "Config - Post Processing"
#set global $header = "Post Processing Configuration"

#set global $sbPath="../.."

#set global $topmenu="config"#
#include $os.path.join($sickbeard.PROG_DIR, "data/interfaces/default/inc_top.tmpl")

<script type="text/javascript" src="$sbRoot/js/configPostProcessing.js"></script>
<script type="text/javascript" src="$sbRoot/js/config.js"></script>

<div id="config">
<div id="config-content">
<h5>All non-absolute folder locations are relative to " <span class="path">$sickbeard.DATA_DIR</span> "</h5>

<form id="configForms" action="savePostProcessing" method="post">

            <div id="config-components">

                <div id="core-component-group1" class="component-group clearfix">

                    <div class="component-group-desc">
                        <h3>Post-Processing</h3>
                        <p>Settings that dictate how Sick Beard should process completed downloads.</p>
                    </div>

                    <fieldset class="component-group-list">
                        <div class="field-pair">
                            <label class="nocheck clearfix" for="tv_download_dir">
                                <span class="component-title">TV Download Dir</span>
                                <input type="text" name="tv_download_dir" id="tv_download_dir" value="$sickbeard.TV_DOWNLOAD_DIR" size="45" />
                            </label>
                            <label class="nocheck clearfix">
                                <span class="component-title">&nbsp;</span>
                                <span class="component-desc">The folder where your download client puts your TV downloads.</span>
                            </label>
                            <label class="nocheck clearfix">
                                <span class="component-title">&nbsp;</span>
                                <span class="component-desc"><b>NOTE:</b> Use only if not using SABnzbd+ post processing.</span>
                            </label>
                            <label class="nocheck clearfix">
                                <span class="component-title">&nbsp;</span>
                                <span class="component-desc">Or if SABnzbd+ and Sick Beard are on different PCs.</span>
                            </label>
                        </div>

                        <div class="field-pair">
                            <input type="checkbox" name="keep_processed_dir" id="keep_processed_dir" #if $sickbeard.KEEP_PROCESSED_DIR == True then "checked=\"checked\"" else ""# />
                            <label class="clearfix" for="keep_processed_dir">
                                <span class="component-title">Keep Original Files</span>
                                <span class="component-desc">Keep original files after they've been processed?</span>
                            </label>
                        </div>

                        <div class="field-pair">
                            <input type="checkbox" name="move_associated_files" id="move_associated_files" #if $sickbeard.MOVE_ASSOCIATED_FILES == True then "checked=\"checked\"" else ""# />
                            <label class="clearfix" for="move_associated_files">
                                <span class="component-title">Move Associated Files</span>
                                <span class="component-desc">Move srr/srt/sfv/etc files with the episode when processed?</span>
                            </label>
                            <label class="nocheck clearfix" for="move_associated_files">
                                <span class="component-title">&nbsp;</span>
                                <span class="component-desc"><b>NOTE:</b> <i>.nfo</i> will be renamed to <i>.nfo-orig</i> when moved.</span>
                            </label>
                        </div>

                        <div class="field-pair">
                            <input type="checkbox" name="rename_episodes" id="rename_episodes" #if $sickbeard.RENAME_EPISODES == True then "checked=\"checked\"" else ""# />
                            <label class="clearfix" for="rename_episodes">
                                <span class="component-title">Rename Episodes</span>
                                <span class="component-desc">Rename episode using the naming settings below?</span>
                            </label>
                        </div>

                        <div class="field-pair">
                            <input type="checkbox" name="process_automatically" id="process_automatically" #if $sickbeard.PROCESS_AUTOMATICALLY == True then "checked=\"checked\"" else ""# />
                            <label class="clearfix" for="process_automatically">
                                <span class="component-title">Scan and Process</span>
                                <span class="component-desc">Scan and post-process any files in your <i>TV Download Dir</i>?</span>
                            </label>
                            <label class="nocheck clearfix" for="process_automatically">
                                <span class="component-title">&nbsp;</span>
                                <span class="component-desc"><b>NOTE:</b> Do not use if you use sabToSickbeard w/ SABnzbd+!</span>
                            </label>
                        </div>

                        <div class="clearfix"></div>
                        <input type="submit" class="config_submitter" value="Save Changes" /><br/>

                    </fieldset>
                </div><!-- /component-group1 //-->

                <div id="core-component-group2" class="component-group clearfix">
                    <div class="component-group-desc">
                        <h3>Naming</h3>
                        <p>How Sick Beard will name and sort your episodes.</p>
                    </div>

                    <fieldset class="component-group-list">

                        <div class="field-pair">
                            <div class="nocheck clearfix" for="name_presets">
                                <span class="component-title">File Name</span>
                                <select id="name_presets" style="float: left; margin-right: 15px;">
                                    #set $is_custom = True
                                    #for $cur_preset in $naming.name_presets:
                                        #set $tmp = $naming.test_name($cur_preset)
                                        #if $cur_preset == $sickbeard.NAMING_PATTERN:
                                            #set $is_custom = False
                                        #end if
                                        <option id="$cur_preset" #if $cur_preset == $sickbeard.NAMING_PATTERN then "selected=\"selected\" class=\"selected\"" else ""#>$tmp['name']</option>
                                    #end for
                                    #if $is_custom:
                                        <option id="$sickbeard.NAMING_PATTERN" selected="selected" class="selected">Custom...</option>
                                    #end if
                                </select>
                                #if not $is_custom:
                                <input type="button" value="Customize" id="do_custom" />
                                #end if
                                <br />
                            </div>
                        </div>

                        <div id="naming_custom" style="#if $is_custom then "display: block;" else "display: none;"#">
                            <div class="field-pair clearfix">
                                <div class="nocheck clearfix">
                                    <span class="component-title">
                                        &nbsp;
                                    </span>
                                    <span class="component-desc">
                                        <input type="text" size="50" name="naming_pattern" id="naming_pattern" value="$sickbeard.NAMING_PATTERN" />
                                        <img src="$sbRoot/images/legend16.png" width="16" height="16" alt="[Toggle Key]" id="show_naming_key" title="Toggle Naming Legend" style="padding-left: 5px;">
                                    </span>
                                </div>
                            </div>
                            <div id="naming_key" class="nocheck clearfix" style="display: none;">
                                  <table id="Key" class="Key">
                                    <thead>
                                        <tr>
                                          <th class="align-right">Meaning</th>
                                          <th>Pattern</th>
                                          <th width="60%">Result</th>
                                        </tr>
                                    </thead>
                                    <tfoot>
                                        <tr>
                                          <th colspan="3">Use lower case if you want lower case names (eg. %sn, %e.n, %q etc)</th>
                                        </tr>
                                    </tfoot>
                                    <tbody>
                                        <tr>
                                          <td class="align-right"><b>Show Name:</b></td>
                                          <td>%SN</td>
                                          <td>Show Name</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%S.N</td>
                                          <td>Show.Name</td>
                                        </tr>
                                        <tr>
                                          <td>&nbsp;</td>
                                          <td>%S_N</td>
                                          <td>Show_Name</td>
                                        </tr>
                                        <tr class="even">
                                          <td class="align-right"><b>Episode Name:</b></td>
                                          <td>%EN</td>
                                          <td>Episode Name</td>
                                        </tr>
                                        <tr>
                                          <td>&nbsp;</td>
                                          <td>%E.N</td>
                                          <td>Episode.Name</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%E_N</td>
                                          <td>Episode_Name</td>
                                        </tr>
                                        <tr>
                                          <td class="align-right"><b>Season Number:</b></td>
                                          <td>%S</td>
                                          <td>2</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%0S</td>
                                          <td>02</td>
                                        </tr>
                                        <tr>
                                          <td class="align-right"><b>Episode Number:</b></td>
                                          <td>%E</td>
                                          <td>3</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%0E</td>
                                          <td>03</td>
                                        </tr>
                                        <tr>
                                          <td class="align-right"><b>Quality:</b></td>
                                          <td>%QN</td>
                                          <td>720p BluRay</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%Q.N</td>
                                          <td>720p.BluRay</td>
                                        </tr>
                                        <tr>
                                          <td>&nbsp;</td>
                                          <td>%Q_N</td>
                                          <td>720p_BluRay</td>
                                        </tr>
                                        <tr class="even">
                                          <td class="align-right"><b>Air-By-Date:</b></td>
                                          <td>%AD</td>
                                          <td>2010 03 22</td>
                                        </tr>
                                        <tr>
                                          <td>&nbsp;</td>
                                          <td>%A.D</td>
                                          <td>2010.03.22</td>
                                        </tr>
                                        <tr class="even">
                                          <td>&nbsp;</td>
                                          <td>%A_D</td>
                                          <td>2010_03_22</td>
                                        </tr>
                                        <tr>
                                          <td>&nbsp;</td>
                                          <td>%A-D</td>
                                          <td>2010-03-22</td>
                                        </tr>
                                        <tr class="even">
                                          <td class="align-right"><b>Year:</b></td>
                                          <td>%Y</td>
                                          <td>2010</td>
                                        </tr>
                                        <tr>
                                          <td class="align-right"><b>Month:</b></td>
                                          <td>%M</td>
                                          <td>03</td>
                                        </tr>
                                        <tr class="even">
                                          <td class="align-right"><b>Day:</b></td>
                                          <td>%D</td>
                                          <td>22</td>
                                        </tr>
                                        <tr>
                                          <td class="align-right"><b>Release Name:</b></td>
                                          <td>%RN</td>
                                          <td>Show.Name.S02E03.HDTV.XviD-RLSGROUP</td>
                                        </tr>
                                        <tr class="even">
                                          <td class="align-right"><b>Release Group:</b></td>
                                          <td>%RG</td>
                                          <td>RLSGROUP</td>
                                        </tr>
                                    </tbody>
                                  </table>
                                  <br/>
                            </div>
                        </div>

                        <div class="field-pair">
                            <label class="nocheck clearfix" for="naming_multi_ep">
                                <span class="component-title">Multi-episode Style</span>
                                <span class="component-desc">
                                    <select id="naming_multi_ep" name="naming_multi_ep">
                                    #for $cur_multi_ep in $multiEpStrings:
                                        <option value="$cur_multi_ep" #if $cur_multi_ep == $sickbeard.NAMING_MULTI_EP then "selected=\"selected\" class=\"selected\"" else ""#>$multiEpStrings[$cur_multi_ep]</option>
                                    #end for
                                    </select>
                                </span>
                            </label>
                        </div>

                        <div id="naming_example_div">
                            <h2>Result:</h2>
                            <div class="example">
                                <span class="jumbo" id="naming_example">&nbsp;</span>
                            </div>
                        </div>
                        <br/>

                        <div id="naming_example_multi_div">
                            <h2>Multi-Ep Result:</h2>
                            <div class="example">
                                <span class="jumbo" id="naming_example_multi">&nbsp;</span>
                            </div>
                        </div>
                        <br/>

                        <div class="clearfix"></div>
                        <input type="submit" class="config_submitter" value="Save Changes" /><br/>

                    </fieldset>
                </div><!-- /component-group2 //-->

                <div id="core-component-group3" class="component-group clearfix">

                    <div class="component-group-desc">
                        <h3>Metadata</h3>
                        <p>The data associated to the data. These are files associated to a TV show in the form of images and text that, when supported, will enhance the viewing experience.</p>
                    </div>

                    <fieldset class="component-group-list">
                        <div class="field-pair">
                            <label class="clearfix">
                                <span class="component-title jumbo">Metadata Type:</span>
                                <span class="component-desc">
                                    #set $m_dict = $metadata.get_metadata_generator_dict()
                                    <select id="metadataType">
                                    #for ($cur_name, $cur_generator) in $m_dict.items():
                                        <option value="$GenericMetadata.makeID($cur_name)">$cur_name</option>
                                    #end for
                                    </select>
                                </span>
                            </label>
                            <span>Toggle the metadata options that you wish to be created. <b>Multiple targets may be used.</b></span>
                        </div>

                        <div id="metadataLegend">
                            <div style="width: 190px; float: left;">Create:</div>
                            <div style="width: 260px; float: left;">Results:</div>
                        </div>
                        <div class="clearfix"></div>

#for ($cur_name, $cur_generator) in $m_dict.items(): 
#set $cur_metadata_inst = $sickbeard.metadata_provider_dict[$cur_generator.name]
#set $cur_id = $GenericMetadata.makeID($cur_name)
<div class="metadataDiv" id="$cur_id">
    <div class="metadata_options">
        <label for="${cur_id}_show_metadata"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_show_metadata" #if $cur_metadata_inst.show_metadata then "checked=\"checked\"" else ""#/>&nbsp;Show Metadata</label>
        <label for="${cur_id}_episode_metadata"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_episode_metadata" #if $cur_metadata_inst.episode_metadata then "checked=\"checked\"" else ""#/>&nbsp;Episode Metadata</label>
        <label for="${cur_id}_fanart"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_fanart" #if $cur_metadata_inst.fanart then "checked=\"checked\"" else ""#/>&nbsp;Show Fanart Image</label>
        <label for="${cur_id}_poster"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_poster" #if $cur_metadata_inst.poster then "checked=\"checked\"" else ""#/>&nbsp;Show Folder Image</label>
        <label for="${cur_id}_episode_thumbnails"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_episode_thumbnails" #if $cur_metadata_inst.episode_thumbnails then "checked=\"checked\"" else ""#/>&nbsp;Episode Thumbnail</label>
        <label for="${cur_id}_season_thumbnails"><input type="checkbox" class="metadata_checkbox" id="${cur_id}_season_thumbnails" #if $cur_metadata_inst.season_thumbnails then "checked=\"checked\"" else ""#/>&nbsp;Season Thumbnail</label>
    </div>
    <div class="metadata_example">
        <label for="${cur_id}_show_metadata"><span id="${cur_id}_eg_show_metadata">$cur_metadata_inst.eg_show_metadata</span></label>
        <label for="${cur_id}_episode_metadata"><span id="${cur_id}_eg_episode_metadata">$cur_metadata_inst.eg_episode_metadata</span></label>
        <label for="${cur_id}_fanart"><span id="${cur_id}_eg_fanart">$cur_metadata_inst.eg_fanart</span></label>
        <label for="${cur_id}_poster"><span id="${cur_id}_eg_poster">$cur_metadata_inst.eg_poster</span></label>
        <label for="${cur_id}_episode_thumbnails"><span id="${cur_id}_eg_episode_thumbnails">$cur_metadata_inst.eg_episode_thumbnails</span></label>
        <label for="${cur_id}_season_thumbnails"><span id="${cur_id}_eg_season_thumbnails">$cur_metadata_inst.eg_season_thumbnails</span></label>
    </div>
    <input type="hidden" name="${cur_id}_data" id="${cur_id}_data" value="$cur_metadata_inst.get_config()" />
</div>
#end for

                        <div class="clearfix" style="clear:left;"></div>

                        <div class="field-pair clearfix">
                            <input type="checkbox" name="use_banner" id="use_banner" #if $sickbeard.USE_BANNER then "checked=checked" else ""#/>
                            <label class="clearfix" for="use_banner">
                                <span class="component-title">Use Banners</span>
                                <span class="component-desc">Use banners instead of posters for your Show Folder Images</span>
                            </label>
                        </div>

                        <input type="submit" class="config_submitter" value="Save Changes" /><br/>

                    </fieldset>
                </div><!-- /component-group3 //-->


            <br/><input type="submit" class="config_submitter" value="Save Changes" /><br/>
            </div><!-- /config-components -->

</form>
</div></div>
<div class="clearfix"></div>


#include $os.path.join($sickbeard.PROG_DIR, "data/interfaces/default/inc_bottom.tmpl")
